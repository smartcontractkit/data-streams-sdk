# Compress Report

This example demonstrates how to compress a report the [Snappy compression algorithm](https://google.github.io/snappy/).

## Running the example

Make sure you git cloned the [https://github.com/smartcontractkit/data-streams-sdk](https://github.com/smartcontractkit/data-streams-sdk) repository and navigated to the `rust` directory.

```bash
cargo run --example compress_report
```

## Examine the code

The code for this example can be found in the `compress_report.rs` file in the `examples` directory of the `data-streams-sdk` repository.

```rust
use data_streams_sdk::client::Client;
use data_streams_sdk::config::Config;
use data_streams_sdk::feed::ID;
use data_streams_sdk::report::compress::compress_report;
use std::error::Error;

#[tokio::main]
async fn main() -> Result<(), Box<dyn Error>> {
    let api_key = "YOUR_API_KEY_GOES_HERE";
    let user_secret = "YOUR_USER_SECRET_GOES_HERE";
    let rest_url = "https://api.testnet-dataengine.chain.link";
    let ws_url = "wss://api.testnet-dataengine.chain.link/ws";

    let eth_usd_feed_id =
        ID::from_hex_str("0x000359843a543ee2fe414dc14c7e7920ef10f4372990b79d6361cdc0dd1ba782")
            .unwrap();
    let timestamp = 1729506909; // Example timestamp

    // Initialize the configuration
    let config = Config::new(
        api_key.to_string(),
        user_secret.to_string(),
        rest_url.to_string(),
        ws_url.to_string(),
    )
    .build()?;

    // Initialize the client
    let client = Client::new(config)?;

    let response = client.get_report(eth_usd_feed_id, timestamp).await?;

    match compress_report(response.report) {
        Ok(compressed_report) => {
            println!("Compressed Report: {:#?}", hex::encode(&compressed_report));
        }
        Err(e) => {
            eprintln!("Error compressing report: {:#?}", e);
        }
    }

    Ok(())
}
```

## Compress Report RAW

There is also a `compress_report_raw` function that compresseses a raw report payload.

```rust
use data_streams_sdk::report::compress::{compress_report_raw, CompressionError};

fn main() -> Result<(), CompressionError> {
   let raw_report = "7b22666565644944223a22307830303033366234616137653537636137623638616531626634353635336635366236353666643361613333356566376661653639366236363366316238343732222c2276616c696446726f6d54696d657374616d70223a313731383838353737322c226f62736572766174696f6e7354696d657374616d70223a313731383838353737322c2266756c6c5265706f7274223a2230303036626438373833306435663333366532303563663563363333323961316461623866356435363831326561656237633639333030653636616238653232303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030636637656431333030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030306530303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303232303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303033303030313031303030313031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303132303030303330616237643032666262613963363330346639383832343532343430376231663439343734313137343332306366643137613263323265656331646530303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303636613866356336303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036366138663563363030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303035373831303635336464393030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303534313331356461373664363130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036366161343734363030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303039613639376565343233303335303430303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030396136353036643134323664303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303961373764303361653335356665303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303637326261633939316635323333646638396635383164633032613839646438643438343139653335353862323437643365363566343036396661343563333636353861356134383230646339346663343761383861323164383334373463323965653338333832633436623666396135373562396365386265346536383963303363373666616331396662656334613239646261373034633732636330303361366265316639366166313135653332323332316630363838653234373230613564396264373133366131643936383432656338393133333035386238383862326536353732623564343131346465323432363139356530333866316339613563653530303136623666356135646530376530383532396238343565316336323264636265666130636661326666643132386539393332656365653865666438363962633536643039613530636562333630613864333636636661386565666533663634323739633838626462633838373536306566613939343432333865623030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036306532613830306631363966323631363435333363376661666636633930373363643664623234306438393434346433343837313133323332663963333134323261303939336262343764353638303764306463323637323865346338343234626239646237373531313030313930343335336631303232313638373233303130633436363237633839306265366537303165373636363739363030363936383636633838386563383065376462643432386635313632613234663264383236326638343662646230366439653436643239356464386538393666623233326265383035333462303034313636306665343435306137656465396263336232333037323233383137373361346165383132343135363838363761373539663533633262646430356433326232303965373838343566633538323033393439653530613630383934326232373063343536303031653537383232376164303038363163663566343762323762303931333761306334623766386234373436636566227d";
   let report = hex::decode(raw_report).unwrap();

   let compressed_report = compress_report_raw(&report).unwrap();

    Ok(())
}
```
